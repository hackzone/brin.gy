<script src="http://code.jquery.com/jquery-1.6.2.min.js"></script>

<script>
poll_responses = function()
{
    $.getJSON("/polljob/agent1",{},function(json){
//         console.log(json);
        $("#responses").html("responses:"+json);
    });
};

job = function(){
    data = {itemid:"ipad000000", price:30, action:"sell", agent:"pol"};
    $.post("http://localhost:22222/buysell",data,function(json){
//         console.log(json);
        
        $("#responses").html("responses:"+JSON.stringify(json));
    }, "json");
};

$(document).ready(function()
{
    $("#container").click(function(){
        for (i=0;i<10;i++) {
            $.getJSON("/startjob/agent"+i+"?ttl=100",{},function(json){
                $("#result").append("started job: "+json.job+"<br>");
            });
        }
    });
    
    $.getJSON("/jobs",{},function(json){
        console.log(json);
        for (i in json.jobs)
            $("#result").append("existing job: "+json.jobs[i]+"<br>");
    });
    
//     setInterval(poll_responses, 1000);
    setInterval(job, 1000);
});
</script>

<body>
<div id="container">start jobs</div>
<div id="result"></div>
<div id="responses"></div>
</body>
